      PROGRAM GENSPEC
	USE MSFLIB
C     Program to generate fictitious spectra for testing fitting routine.
      DIMENSION WL(60000),REF1(60000),REF2(60000),RES(60000)
      DIMENSION FL1(5)
	COMMON /NUNIT/ NU, NUOUT, IFOUT
	CHARACTER * 24 FL1
	CHARACTER * 7 LABEL
	INTEGER(4) RESULT
	DOUBLE PRECISION START1,DLT,A
	DATA IN1,NOUT1,NOUT2,NOUT3/1,2,3,4/
  100 FORMAT (A24)
  101 FORMAT (F15.6,E15.6)
C**********************************************************************
      RESULT=SETEXITQQ(QWIN$EXITNOPERSIST)
	OPEN (UNIT = 5,     FILE='C:\SPSYN\GENSPEC.ILS', STATUS = 'OLD')
	READ (5, 100)       (FL1(J),J=1,4)
	OPEN (UNIT = IN1,   FILE = FL1(1),  STATUS = 'OLD')
	OPEN (UNIT = NOUT1, FILE = FL1(2),  STATUS = 'REPLACE')
	OPEN (UNIT = NOUT2, FILE = FL1(3),  STATUS = 'REPLACE')
	OPEN (UNIT = NOUT3, FILE = FL1(4),  STATUS = 'REPLACE')
C***********************************************************************
      LABEL = 'GENSPEC'
	LBLERR=0
	NU=IN1
	CALL GTLBL( LABEL, LBLERR)
	IF (LBLERR.EQ.(-1)) CALL PMDSTOP
	CALL EREAD (VPT, 'F10.1')
	NPOINT=VPT
	CALL EREAD (START, 'F10.1')
	START1=START
	CALL EREAD (END, 'F10.1')
	CALL EREAD (FLX, 'F10.1')
	CALL EREAD (SIGMA,'F6.3')
	DLT=(END-START)/(VPT-1.0)
	DO J=1,NPOINT
		A=START1+(J-1)*DLT
		WL(J)=A
		REF1(J)=FLX
	END DO
	DO J=1,NPOINT
		IFLAG=0
		RNDERR=GASDEV(IFLAG)
		DL=SIGMA*RNDERR
		REF2(J)=REF1(J)+DL
		RES(J)=DL
	END DO
	DO J=1,NPOINT
		C=WL(J)
		B=REF1(J)
		WRITE (NOUT1,101) C,B
	END DO
	DO J=1,NPOINT
		C=WL(J)
		B=REF2(J)
		WRITE (NOUT2,101) C,B
	END DO
	DO J=1,NPOINT
		C=WL(J)
		B=RES(J)
		WRITE (NOUT3,101) C,B
	END DO
	CLOSE (UNIT = IN1,   STATUS = 'KEEP')
	CLOSE (UNIT = NOUT1, STATUS = 'KEEP')
	CLOSE (UNIT = NOUT2, STATUS = 'KEEP')
	CLOSE (UNIT = NOUT3, STATUS = 'KEEP')
      STOP
	END